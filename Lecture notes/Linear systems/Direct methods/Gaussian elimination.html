
<!DOCTYPE html>


<html lang="en" data-content_root="../../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Solving linear systems with Gauss elimination &#8212; My Jupyter Book</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!-- 
    this give us a css class that will be invisible only if js is disabled 
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- So that users can add custom icons -->
  <script src="../../../_static/scripts/fontawesome.js?digest=26a4bc78f4c0ddb94549"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549" />
<link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549" />

    <script src="../../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Lecture notes/Linear systems/Direct methods/Gaussian elimination';</script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../../index.html">
  
  
  
  
  
  
    <p class="title logo__title">My Jupyter Book</p>
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../../index.html">
                    Welcome
                </a>
            </li>
        </ul>
        <ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Root%20finding/Root%20finding.html">Root finding</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Root%20finding/Polynomial%20roots.html">Polynomial roots</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Root%20finding/Closed%20methods.html">Closed root-finding methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Root%20finding/Open%20methods.html">Open methods</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../Root%20finding/Global%20convergence%20methods.html">‘Global’ convergence</a></li>
</ul>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../../_sources/Lecture notes/Linear systems/Direct methods/Gaussian elimination.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Solving linear systems with Gauss elimination</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Solving linear systems with Gauss elimination</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#symbolic-manipulation">Symbolic manipulation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#numerical-approach">Numerical approach</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#gauss-elimination">Gauss Elimination</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#gauss-elimination-algorithm">Gauss elimination algorithm</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#steps-from-our-previous-example">Steps from our previous example</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#algorithm">Algorithm</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#example">Example</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#complexity">Complexity</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Complexity</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#package-implementation">Package implementation</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#pivoting-and-diagonal-dominance">Pivoting and diagonal dominance</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#diagonal-dominance">Diagonal dominance</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#importance-of-diagonal-dominance">Importance of diagonal dominance</a></li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <p><a href="https://colab.research.google.com/github/mwelland/ENGPYHS_3NM4/blob/main/Linear_systems_2.ipynb" target="_parent"><img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab"/></a></p>
<section class="tex2jax_ignore mathjax_ignore" id="solving-linear-systems-with-gauss-elimination">
<h1>Solving linear systems with Gauss elimination<a class="headerlink" href="#solving-linear-systems-with-gauss-elimination" title="Link to this heading">#</a></h1>
<p>Gauss elimination is an algorithm for the most familiar / intuitive solution technique. Let’s reexamine our analytical (symbolic) solution to the previous problem and then make it into a numerical algorithm.</p>
<p>Question:
You are organizing a fundraising event and need to buy chairs and tables. Chairs cost $20 each and tables cost $50 each. You have a budget of $700 and need a total of 20 pieces of furniture (chairs and tables combined). How many chairs and tables should you buy?</p>
<section id="symbolic-manipulation">
<h2>Symbolic manipulation<a class="headerlink" href="#symbolic-manipulation" title="Link to this heading">#</a></h2>
<p>Let <span class="math notranslate nohighlight">\(c\)</span> and <span class="math notranslate nohighlight">\(t\)</span> be the number of chairs and tables respectively.</p>
<p>The budget and pieces equations are,</p>
<p>(1) <span class="math notranslate nohighlight">\(20 c + 50 t = 700\)</span></p>
<p>(2) <span class="math notranslate nohighlight">\(  c+t = 20\)</span></p>
<p>Solve (2) for <span class="math notranslate nohighlight">\(c\)</span>:</p>
<p><span class="math notranslate nohighlight">\(c = 20-t\)</span></p>
<p>Substitute into (1):</p>
<p><span class="math notranslate nohighlight">\(20 [20-t] + 50t = 700\)</span></p>
<p><span class="math notranslate nohighlight">\(t = 10\)</span></p>
<p>and substitute into (2) or (1) to find <span class="math notranslate nohighlight">\(c\)</span>.</p>
<p>This works because our first step carries the unkown <em>symbol</em> <span class="math notranslate nohighlight">\(t\)</span>.</p>
</section>
<section id="numerical-approach">
<h2>Numerical approach<a class="headerlink" href="#numerical-approach" title="Link to this heading">#</a></h2>
<p>Lets repeat this without carrying symbols.</p>
<p>(1) <span class="math notranslate nohighlight">\(20 c + 50 t = 700\)</span></p>
<p>(2) <span class="math notranslate nohighlight">\(  c+t = 20\)</span></p>
<p>Multiply (2) by <span class="math notranslate nohighlight">\(20\)</span>:</p>
<p><span class="math notranslate nohighlight">\(20 c + 20 t = 400\)</span></p>
<p>and subtract from (1):</p>
<p>\begin{eqnarray*}
20 c + &amp;50 t  &amp;=&amp; 700 \
-20 c - &amp;20 t &amp;=&amp; -400 \
\hline
&amp;30 t &amp;=&amp; 300
\end{eqnarray*}</p>
<p>Thus we have simplified the last line until it reaches a trival solution for <span class="math notranslate nohighlight">\(t\)</span>. Now it is a matter of <em>substitution</em> to solve for <span class="math notranslate nohighlight">\(c\)</span>.</p>
<p>NB: the linear system has been changed (without changing the answer) to:</p>
<p><span class="math notranslate nohighlight">\(\begin{pmatrix}
20 &amp; 50 \\
0 &amp; 30
\end{pmatrix}
\begin{pmatrix}
c \\
t
\end{pmatrix} =
\begin{pmatrix}
700 \\
300
\end{pmatrix}\)</span></p>
<p>In particular, <span class="math notranslate nohighlight">\(A\)</span> is <em>upper triangular</em>, (aka <em>row echelon form</em> for a square matrix) from which the answer is easily obtained through <em>backward substitution</em>.</p>
<p>##Upper triangular matricies</p>
<p>An upper triangular matrix, <span class="math notranslate nohighlight">\(U\)</span>, is a matrix whose elements below the diagonal are zero:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{bmatrix}
u_{1,1} &amp; u_{1,2} &amp; u_{1,3} &amp; u_{1,4}\\
0 &amp; u_{2,2}' &amp; u_{2,3}' &amp; u_{2,4}'\\
0 &amp; 0 &amp; u_{3,3}' &amp; u_{3,4}' \\
0 &amp; 0 &amp; 0 &amp; u_{4,4}'
\end{bmatrix}\end{split}\]</div>
<p>This is useful because, in equation form,</p>
<p><span class="math notranslate nohighlight">\(U x = b'\)</span></p>
<p>turns in to
\begin{eqnarray*}
\begin{array}{}
u_{1,1} x_1 &amp;+&amp; u_{1,2} x_2 &amp; + &amp; u_{1,3} x_{3} &amp;+&amp;u_{1,4} x_4 &amp;=&amp; b’<em>1,\
&amp; &amp; u</em>{2,2}’ x_{2} &amp;+ &amp; u_{2,3}’ x_{3} &amp;+&amp; u_{2,4}’ x_4 &amp;=&amp; b_{2}’ \
&amp;&amp; &amp; &amp; u_{3,3}’ x_{3} &amp;+&amp; u_{3,4}’ x_4 &amp;=&amp; b_{3}’,\
&amp;&amp; &amp;&amp; &amp;&amp; u_{4,4}’ x_4 &amp;=&amp; b_{4}’.
\end{array}
\end{eqnarray*}</p>
<p>which can be solved in <span class="math notranslate nohighlight">\(O(n^2)\)</span> time!</p>
</section>
<section id="gauss-elimination">
<h2>Gauss Elimination<a class="headerlink" href="#gauss-elimination" title="Link to this heading">#</a></h2>
<p>Gauss Elimination proceeds in two phases. The first is elimination which transforms</p>
<p><span class="math notranslate nohighlight">\(A x = b\)</span></p>
<p>into</p>
<p><span class="math notranslate nohighlight">\(U x = b'\)</span></p>
<p>where <span class="math notranslate nohighlight">\(U\)</span> is an upper triangular matrix and <span class="math notranslate nohighlight">\(b'\)</span> is a modified vector of constants. The second phase is back-substitution which is trivial with triangular matricies.</p>
<section id="gauss-elimination-algorithm">
<h3>Gauss elimination algorithm<a class="headerlink" href="#gauss-elimination-algorithm" title="Link to this heading">#</a></h3>
<p>We first take</p>
<p><span class="math notranslate nohighlight">\(Ax = b\)</span></p>
<p>and build an <em>Augmented matrix</em>:</p>
<p><span class="math notranslate nohighlight">\(Ab = [ A | b ]\)</span></p>
<p>We are allowed the following operations which affect <span class="math notranslate nohighlight">\(|A|\)</span> but not the solution to the problem:</p>
<p>|Operation | Effect on <span class="math notranslate nohighlight">\(|A|\)</span> |
|—–|—–|
|Exchange 2 rows | Flips sign|
|Multiply a row by § | Multiplied by § |
|Subtract 2 rows     | Unchanged|</p>
</section>
<section id="steps-from-our-previous-example">
<h3>Steps from our previous example<a class="headerlink" href="#steps-from-our-previous-example" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="c1"># Define A and b</span>

<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">50</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>

<span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">700</span><span class="p">],</span> <span class="p">[</span><span class="mi">20</span><span class="p">]])</span>

<span class="c1">#Form the augmented matrix A|b</span>
<span class="n">Ab</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">([</span><span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">])</span>

<span class="c1">#The coefficient matrix can be separated by slicing Ab</span>
<span class="k">def</span> <span class="nf">print_update</span><span class="p">():</span>
  <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Augmented matrix is </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">Ab</span><span class="p">)</span>
  <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Determinant of A: &quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">det</span><span class="p">(</span><span class="n">Ab</span><span class="p">[:,:</span><span class="o">-</span><span class="mi">1</span><span class="p">])),</span>
  <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Norm of A&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">Ab</span><span class="p">[:,:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;fro&#39;</span><span class="p">)),</span>
  <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Condition number of A:&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">cond</span><span class="p">(</span><span class="n">Ab</span><span class="p">[:,</span> <span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
  <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Step 0: Show the augmented matrix and the determinant of A&quot;</span><span class="p">)</span>
<span class="n">print_update</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Step 1: Multiply the second row by 20&quot;</span><span class="p">)</span>
<span class="n">Ab</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">Ab</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">*</span> <span class="mi">20</span>
<span class="n">print_update</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Step 2: Subtract the second row from the first&quot;</span><span class="p">)</span>
<span class="n">Ab</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">Ab</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">-</span> <span class="n">Ab</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span>
<span class="n">print_update</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Step 0: Show the augmented matrix and the determinant of A
Augmented matrix is 
 [[ 20  50 700]
 [  1   1  20]]
Determinant of A:  -29.99999999999999
Norm of A 53.87021440462252
Condition number of A: 96.72299453018881


Step 1: Multiply the second row by 20
Augmented matrix is 
 [[ 20  50 700]
 [ 20  20 400]]
Determinant of A:  -600.0
Norm of A 60.8276253029822
Condition number of A: 6.000000000000001


Step 2: Subtract the second row from the first
Augmented matrix is 
 [[  20   50  700]
 [   0  -30 -300]]
Determinant of A:  -600.0
Norm of A 61.644140029689765
Condition number of A: 6.171292729553326
</pre></div>
</div>
</div>
</div>
<p>Note: The determinant, norm and condition number are all changing despite the answer remaining the same. This is the basis of preconditioners!</p>
</section>
<section id="algorithm">
<h3>Algorithm<a class="headerlink" href="#algorithm" title="Link to this heading">#</a></h3>
<p>Let’s describe an algorithm for Gaussian elimination, as a sequence of passes row by row through the matrix.</p>
<p>Each pass we choose a <em>pivot row</em> which is used to eliminate the elements in other equations through multiplication of the pivot and subtraction.</p>
<p>Start from the top and only pass downwards, so we end up with an upper triangular matrix.</p>
<section id="example">
<h4>Example<a class="headerlink" href="#example" title="Link to this heading">#</a></h4>
<p>Use Gauss Elimination to solve the following equations.</p>
<p>\begin{eqnarray*}
4x_1 + 3x_2 - 5x_3 &amp;=&amp; 2 \
-2x_1 - 4x_2 + 5x_3 &amp;=&amp; 5 \
8x_1 + 8x_2  &amp;=&amp; -3 \
\end{eqnarray*}</p>
<p>Step 1: Turn these equations to matrix form <span class="math notranslate nohighlight">\(Ax=y\)</span>.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{bmatrix}
4 &amp; 3 &amp; -5\\
-2 &amp; -4 &amp; 5\\
8 &amp; 8 &amp; 0\\
\end{bmatrix}\left[\begin{array}{c} x_1 \\x_2 \\x_3 \end{array}\right] =
\left[\begin{array}{c} 2 \\5 \\-3\end{array}\right]\end{split}\]</div>
<p>Step 2: Get the augmented matrix [A, y]</p>
<div class="math notranslate nohighlight">
\[\begin{split}
[A, y]  = \begin{bmatrix}
4 &amp; 3 &amp; -5 &amp; 2\\
-2 &amp; -4 &amp; 5 &amp; 5\\
8 &amp; 8 &amp; 0 &amp; -3\\
\end{bmatrix}\end{split}\]</div>
<p>Step 3: Choose the first equation as the pivot equation and turn the 2nd row first element to 0. To do this, we can multiply -0.5 for the 1st row (pivot equation) and subtract it from the 2nd row. The multiplier is <span class="math notranslate nohighlight">\(m_{2,1}=-0.5\)</span>. We will get</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{bmatrix}
4 &amp; 3 &amp; -5 &amp; 2\\
0 &amp; -2.5 &amp; 2.5 &amp; 6\\
8 &amp; 8 &amp; 0 &amp; -3\\
\end{bmatrix}\end{split}\]</div>
<p>Step 4: Turn the 3rd row first element to 0. We can do something similar, multiply 2 to the 1st row and subtract it from the 3rd row. The multiplier is <span class="math notranslate nohighlight">\(m_{3,1}=2\)</span>. We will get</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{bmatrix}
4 &amp; 3 &amp; -5 &amp; 2\\
0 &amp; -2.5 &amp; 2.5 &amp; 6\\
0 &amp; 2 &amp; 10 &amp; -7\\
\end{bmatrix}\end{split}\]</div>
<p>Step 5: Turn the 3rd row 2nd element to 0. We can multiple -4/5 for the 2nd row, and subtract it from the 3rd row. The multiplier is <span class="math notranslate nohighlight">\(m_{3,2}=-0.8\)</span>. We will get</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{bmatrix}
4 &amp; 3 &amp; -5 &amp; 2\\
0 &amp; -2.5 &amp; 2.5 &amp; 6\\
0 &amp; 0 &amp; 12 &amp; -2.2\\
\end{bmatrix}\end{split}\]</div>
<p>Elmination is now complete since <span class="math notranslate nohighlight">\(A\)</span> is upper triangular.</p>
<p>Proceed with substitution:</p>
<p>Step 6: Therefore, we can get <span class="math notranslate nohighlight">\(x_3=-2.2/12=-0.183\)</span>.</p>
<p>Step 7: Insert <span class="math notranslate nohighlight">\(x_3\)</span> to the 2nd equation, we get <span class="math notranslate nohighlight">\(x_2=-2.583\)</span></p>
<p>Step 8: Insert <span class="math notranslate nohighlight">\(x_2\)</span> and <span class="math notranslate nohighlight">\(x_3\)</span> to the first equation, we have <span class="math notranslate nohighlight">\(x_1=2.208\)</span>.</p>
</section>
</section>
<section id="complexity">
<h3>Complexity<a class="headerlink" href="#complexity" title="Link to this heading">#</a></h3>
<p>Considering the two phases of Gauss elimination:</p>
<p>Elimination: ~<span class="math notranslate nohighlight">\(n^3/3\)</span> operations, therefore, <span class="math notranslate nohighlight">\(O(n^3)\)</span></p>
<p>Back substitution: ~ <span class="math notranslate nohighlight">\(n^2/2\)</span> operations, therefore <span class="math notranslate nohighlight">\(O(n^2)\)</span></p>
<p>##Gauss-Jordan Elimination
An obvious extension is to conduct each pass both upwards and downwards (G.E. is just down). While doing this we also normalize the row to get reduced row echelon form (abbreviated: rref):</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{bmatrix}
1 &amp; 0 &amp; 0 &amp; 2.208\\
0 &amp; 1 &amp; 0 &amp; -2.583\\
0 &amp; 0 &amp; 1 &amp; -0.183\\
\end{bmatrix}\end{split}\]</div>
<p>Since <span class="math notranslate nohighlight">\(I^{-1} = I\)</span>, the answer is just the right hand vector.</p>
</section>
<section id="id1">
<h3>Complexity<a class="headerlink" href="#id1" title="Link to this heading">#</a></h3>
<p>Gauss-Jordan Elimination eliminates the need for back-substitution so one might think that it is more efficient than Gauss Elimination. Unfortunatley, the elimination phase takes ~<span class="math notranslate nohighlight">\(~n^3/2\)</span> operations whereas GE took ~<span class="math notranslate nohighlight">\(n^3/3 + n^2/2\)</span>. therefore Gauss Elimination is preferred.</p>
</section>
</section>
<section id="package-implementation">
<h2>Package implementation<a class="headerlink" href="#package-implementation" title="Link to this heading">#</a></h2>
<p>Gaussian Elimination is fundamental but has largely been surpased by matrix decomposition (We will see the connection soon). Therefore, you will be hard pressed to find a standard implemention in numperical packages (numpy / scipy).</p>
<p>It is still useful in symbolic manipulation, and indeed you will find it in <em>sympy</em> under <em>echelon form</em> and <em>rref</em>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#prompt: Use sympy rref and echelon form to make an example for linear system</span>

<span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">Matrix</span><span class="p">,</span> <span class="n">symbols</span><span class="p">,</span> <span class="n">pprint</span>

<span class="n">a</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>

<span class="c1"># Define the coefficient matrix and the right-hand side vector</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
            <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
            <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">]])</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">])</span>

<span class="c1"># Combine the coefficient matrix and the right-hand side vector into an augmented matrix</span>
<span class="n">Ab</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">row_join</span><span class="p">(</span><span class="n">Matrix</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>

<span class="c1"># Calculate the reduced row echelon form (rref) of the augmented matrix</span>
<span class="n">Ab_rref</span> <span class="o">=</span> <span class="n">Ab</span><span class="o">.</span><span class="n">rref</span><span class="p">()</span>

<span class="c1"># Print the result</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Augmented matrix in rref:&quot;</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">Ab_rref</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

<span class="c1"># Calculate the echelon form of the coefficient matrix</span>
<span class="n">Ab_echelon</span> <span class="o">=</span> <span class="n">Ab</span><span class="o">.</span><span class="n">echelon_form</span><span class="p">()</span>

<span class="c1"># Print the result</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Coefficient matrix in echelon form:&quot;</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">Ab_echelon</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Augmented matrix in rref:
⎡1  0  -1  0⎤
⎢           ⎥
⎢0  1  2   0⎥
⎢           ⎥
⎣0  0  0   1⎦

Coefficient matrix in echelon form:
⎡1  2   3   2 ⎤
⎢             ⎥
⎢0  -3  -6  -3⎥
⎢             ⎥
⎣0  0   0   33⎦
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="pivoting-and-diagonal-dominance">
<h1>Pivoting and diagonal dominance<a class="headerlink" href="#pivoting-and-diagonal-dominance" title="Link to this heading">#</a></h1>
<p>The order of equations, and therefore rows in the matrix, is obviously arbitrary, but this may break Gauss Elimination.</p>
<p>E.g.: a system with augmented matrix</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{bmatrix}
2 &amp; -1 &amp; 0 &amp; 1\\
-1 &amp; 2 &amp; -1 &amp; 0\\
0 &amp; -1 &amp; 1 &amp; 0\\
\end{bmatrix}\end{split}\]</div>
<p>will work with our GE scheme, but the same system reordered,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{bmatrix}
0 &amp; -1 &amp; 1 &amp; 0\\
-1 &amp; 2 &amp; -1 &amp; 0\\
2 &amp; -1 &amp; 0 &amp; 1\\
\end{bmatrix}\end{split}\]</div>
<p>will fail due to the <span class="math notranslate nohighlight">\(0\)</span> in the element of the first row. The remedy is to swap rows 3 and 1 to match the first example.</p>
<p>###Permutation matrix
Swapping rows in matrix algebra is achieved via a <em>permutation matrix</em> (row swap of the <em>identity matrix</em>).</p>
<p>To swap rows 3 and 1, we would use:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
P =
\begin{bmatrix}
0 &amp; 0 &amp; 1 \\
0 &amp; 1 &amp; 0 \\
1 &amp; 0 &amp; 0 \\
\end{bmatrix}\end{split}\]</div>
<section id="diagonal-dominance">
<h2>Diagonal dominance<a class="headerlink" href="#diagonal-dominance" title="Link to this heading">#</a></h2>
<p>More generally, if the diagonal element is <em>small</em> we will encounter roundoff error:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{bmatrix}
\epsilon &amp; -1 &amp; 1 &amp; 0\\
-1 &amp; 2 &amp; -1 &amp; 0\\
2 &amp; -1 &amp; 0 &amp; 1\\
\end{bmatrix}\end{split}\]</div>
<p>after the first pass leads to:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{bmatrix}
\epsilon &amp; -1 &amp; 1 &amp; 0\\
-1 &amp; 2 -1/\epsilon &amp; -1 + 1/\epsilon &amp; 0\\
2 &amp; -1 -1/\epsilon&amp; + 1/\epsilon &amp; 1\\
\end{bmatrix}\end{split}\]</div>
<p>from which we immediately see the danger as <span class="math notranslate nohighlight">\(\epsilon \rightarrow 0\)</span>!</p>
<p>Thus, we don’t want the diagonal to have <span class="math notranslate nohighlight">\(0\)</span>s or <em>small</em> numbers. This motivates the definition of <em>diagonal dominance</em>.</p>
<p>A matrix is said to be <em>diagonally dominant</em> if each diagonal is larger, in absolute value, than the <em>sum of the other elements in the row</em>.</p>
<p><span class="math notranslate nohighlight">\(|A_{ii}| \ge \sum_{j=1,j \ne i}^{n} |A_{ij}|\)</span></p>
<p>Example: Which is diagonally dominant?</p>
<p>a) $<span class="math notranslate nohighlight">\(
\begin{bmatrix}
-2 &amp; 4 &amp; -1 \\
-1 &amp; -1 &amp; 3 \\
4 &amp; -2 &amp; 1 \\
\end{bmatrix}\)</span>$</p>
<p>b)
$<span class="math notranslate nohighlight">\(
\begin{bmatrix}
4 &amp; -2 &amp; 1 \\
-2 &amp; 4 &amp; -1 \\
-1 &amp; -1 &amp; 3 \\
\end{bmatrix}\)</span>$</p>
</section>
<section id="importance-of-diagonal-dominance">
<h2>Importance of diagonal dominance<a class="headerlink" href="#importance-of-diagonal-dominance" title="Link to this heading">#</a></h2>
<p>It can be shown that if a matrix is diagonally dominant, <em>it will not benefit from pivoting!</em>.</p>
<p>Diagonal dominance contributes generally to numerical stability and accuracy through minimizing roundoff error propogation. This result extends beyond Gauss elimination, and will also be a criteria for matrix factorization methods and the efficient convergence of iterative methods.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./Lecture notes/Linear systems/Direct methods"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Solving linear systems with Gauss elimination</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#symbolic-manipulation">Symbolic manipulation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#numerical-approach">Numerical approach</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#gauss-elimination">Gauss Elimination</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#gauss-elimination-algorithm">Gauss elimination algorithm</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#steps-from-our-previous-example">Steps from our previous example</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#algorithm">Algorithm</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#example">Example</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#complexity">Complexity</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Complexity</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#package-implementation">Package implementation</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#pivoting-and-diagonal-dominance">Pivoting and diagonal dominance</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#diagonal-dominance">Diagonal dominance</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#importance-of-diagonal-dominance">Importance of diagonal dominance</a></li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By The Jupyter Book community
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../../../_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549"></script>
<script defer src="../../../_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>